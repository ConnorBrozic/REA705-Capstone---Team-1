##REA705 Team 1 Code Submission
##BY: Connor Brozic, Abhayjot Ressi, Ali Jalali, Jonathan Montiero
##This is the configuration file for Graylog, and is used to create the visual dashboard that collects all information from the four cloud honeypot instances.  
##Each entry in this JSON corresponds to a widget in our dashboard.


{
   "name":"REA705 Submission",
   "description":"Code Submission for REA705",
   "category":"N/A",
   "inputs":[
      {
         "id":"5bdb369830bdb10ae2c954d1",
         "title":"Floreant",
         "configuration":{
            "expand_structured_data":false,
            "recv_buffer_size":262144,
            "port":1514,
            "override_source":null,
            "force_rdns":false,
            "allow_override_date":true,
            "bind_address":"0.0.0.0",
            "store_full_message":false
         },
         "static_fields":{

         },
         "type":"org.graylog2.inputs.syslog.udp.SyslogUDPInput",
         "global":false,
         "extractors":[
            {
               "title":"IP Address",
               "type":"REGEX",
               "cursor_strategy":"COPY",
               "target_field":"IP_Address",
               "source_field":"message",
               "configuration":{
                  "regex_value":"([0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3})"
               },
               "converters":[

               ],
               "condition_type":"NONE",
               "condition_value":"",
               "order":0
            }
         ]
      }
   ],
   "streams":[
      {
         "id":"000000000000000000000001",
         "title":"All messages",
         "description":"Stream containing all messages",
         "disabled":false,
         "matching_type":"AND",
         "stream_rules":[

         ],
         "outputs":[

         ],
         "default_stream":true
      }
   ],
   "outputs":[

   ],
   "dashboards":[
      {
         "title":"Capstone",
         "description":"REA705",
         "dashboard_widgets":[
            {
               "description":"Query on Bogus CC# Table",
               "type":"SEARCH_RESULT_CHART",
               "cache_time":10,
               "configuration":{
                  "interval":"minute",
                  "timerange":{
                     "type":"relative",
                     "range":3600
                  },
                  "query":"application_name:mySQL-queries && message:payment_info"
               },
               "col":1,
               "row":4,
               "height":1,
               "width":2
            },
            {
               "description":"SQL Server Conn. (Localhost)",
               "type":"SEARCH_RESULT_CHART",
               "cache_time":10,
               "configuration":{
                  "interval":"minute",
                  "timerange":{
                     "type":"relative",
                     "range":3600
                  },
                  "query":"application_name:mySQL-queries && message:Connect && message:\"root@localhost\""
               },
               "col":2,
               "row":2,
               "height":1,
               "width":1
            },
            {
               "description":"SQL Server Conn. (Remote)",
               "type":"SEARCH_RESULT_CHART",
               "cache_time":10,
               "configuration":{
                  "interval":"minute",
                  "timerange":{
                     "type":"relative",
                     "range":3600
                  },
                  "query":"application_name:mySQL-queries && message:Connect && message:root && !message:localhost"
               },
               "col":2,
               "row":3,
               "height":1,
               "width":1
            },
            {
               "description":"SQL Database Activity",
               "type":"SEARCH_RESULT_CHART",
               "cache_time":10,
               "configuration":{
                  "interval":"minute",
                  "timerange":{
                     "type":"relative",
                     "range":3600
                  },
                  "query":"application_name:mySQL-queries"
               },
               "col":2,
               "row":1,
               "height":1,
               "width":1
            },
            {
               "description":"Web Portal Activity",
               "type":"SEARCH_RESULT_CHART",
               "cache_time":10,
               "configuration":{
                  "interval":"minute",
                  "timerange":{
                     "type":"relative",
                     "range":3600
                  },
                  "query":"application_name:\"WebSwing\""
               },
               "col":1,
               "row":3,
               "height":1,
               "width":1
            },
            {
               "description":"MySQL - IPs - Lifetime (AWS)",
               "type":"QUICKVALUES",
               "cache_time":10,
               "configuration":{
                  "timerange":{
                     "type":"relative",
                     "range":0
                  },
                  "field":"IP_Address",
                  "query":"application_name:mySQL-queries && source:ip-172-26-6-167",
                  "show_data_table":true,
                  "limit":50,
                  "show_pie_chart":true,
                  "sort_order":"desc",
                  "stacked_fields":"",
                  "data_table_limit":50
               },
               "col":4,
               "row":1,
               "height":3,
               "width":1
            },
            {
               "description":"Web Portal - IPs - Lifetime (AWS)",
               "type":"QUICKVALUES",
               "cache_time":10,
               "configuration":{
                  "timerange":{
                     "type":"relative",
                     "range":0
                  },
                  "field":"IP_Address",
                  "query":"application_name:\"WebSwing\" && source:ip-172-26-6-167",
                  "show_data_table":true,
                  "limit":50,
                  "show_pie_chart":true,
                  "sort_order":"desc",
                  "stacked_fields":"",
                  "data_table_limit":50
               },
               "col":5,
               "row":1,
               "height":3,
               "width":1
            },
            {
               "description":"MySQL - IPs - Lifetime (Azure)",
               "type":"QUICKVALUES",
               "cache_time":10,
               "configuration":{
                  "timerange":{
                     "type":"relative",
                     "range":0
                  },
                  "field":"IP_Address",
                  "query":"application_name:mySQL-queries && source:azure-floreant",
                  "show_data_table":true,
                  "limit":50,
                  "show_pie_chart":true,
                  "sort_order":"desc",
                  "stacked_fields":"",
                  "data_table_limit":50
               },
               "col":4,
               "row":4,
               "height":3,
               "width":1
            },
            {
               "description":"Web Portal - IPs - Lifetime (Azure)",
               "type":"QUICKVALUES",
               "cache_time":10,
               "configuration":{
                  "timerange":{
                     "type":"relative",
                     "range":0
                  },
                  "field":"IP_Address",
                  "query":"application_name:\"WebSwing\" && source:azure-floreant",
                  "show_data_table":true,
                  "limit":50,
                  "show_pie_chart":true,
                  "sort_order":"desc",
                  "stacked_fields":"",
                  "data_table_limit":50
               },
               "col":5,
               "row":4,
               "height":3,
               "width":1
            },
            {
               "description":"MySQL - IPs - Lifetime (OVH)",
               "type":"QUICKVALUES",
               "cache_time":10,
               "configuration":{
                  "timerange":{
                     "type":"relative",
                     "range":0
                  },
                  "field":"IP_Address",
                  "query":"application_name:mySQL-queries && source:vps212252",
                  "show_data_table":true,
                  "limit":50,
                  "show_pie_chart":true,
                  "sort_order":"desc",
                  "stacked_fields":"",
                  "data_table_limit":50
               },
               "col":4,
               "row":7,
               "height":3,
               "width":1
            },
            {
               "description":"Web Portal - IPs - Lifetime (GCP)",
               "type":"QUICKVALUES",
               "cache_time":10,
               "configuration":{
                  "timerange":{
                     "type":"relative",
                     "range":0
                  },
                  "field":"IP_Address",
                  "query":"application_name:\"WebSwing\" && source:floreant-gcp",
                  "show_data_table":true,
                  "limit":50,
                  "show_pie_chart":true,
                  "sort_order":"desc",
                  "stacked_fields":"",
                  "data_table_limit":50
               },
               "col":5,
               "row":10,
               "height":3,
               "width":1
            },
            {
               "description":"MySQL - IPs - Lifetime (GCP)",
               "type":"QUICKVALUES",
               "cache_time":10,
               "configuration":{
                  "timerange":{
                     "type":"relative",
                     "range":0
                  },
                  "field":"IP_Address",
                  "query":"application_name:mySQL-queries && source:floreant-gcp",
                  "show_data_table":true,
                  "limit":50,
                  "show_pie_chart":true,
                  "sort_order":"desc",
                  "stacked_fields":"",
                  "data_table_limit":50
               },
               "col":4,
               "row":10,
               "height":3,
               "width":1
            },
            {
               "description":"Top 10 Hit Locations",
               "type":"QUICKVALUES",
               "cache_time":10,
               "configuration":{
                  "timerange":{
                     "type":"relative",
                     "range":0
                  },
                  "field":"IP_Address_city_name",
                  "query":"",
                  "show_data_table":true,
                  "limit":10,
                  "show_pie_chart":false,
                  "sort_order":"desc",
                  "stacked_fields":"IP_Address_country_code",
                  "data_table_limit":50
               },
               "col":1,
               "row":7,
               "height":2,
               "width":2
            },
            {
               "description":"Map of Hit Locations",
               "type":"org.graylog.plugins.map.widget.strategy.MapWidgetStrategy",
               "cache_time":10,
               "configuration":{
                  "timerange":{
                     "type":"relative",
                     "range":0
                  },
                  "field":"IP_Address_geolocation",
                  "query":""
               },
               "col":1,
               "row":5,
               "height":2,
               "width":2
            },
            {
               "description":"SSH Login Activity (real)",
               "type":"SEARCH_RESULT_CHART",
               "cache_time":10,
               "configuration":{
                  "interval":"minute",
                  "timerange":{
                     "type":"relative",
                     "range":3600
                  },
                  "query":"facility:security\\/authorization"
               },
               "col":1,
               "row":1,
               "height":1,
               "width":1
            },
            {
               "description":"SSH Login Activity (decoy)",
               "type":"SEARCH_RESULT_CHART",
               "cache_time":10,
               "configuration":{
                  "interval":"minute",
                  "timerange":{
                     "type":"relative",
                     "range":3600
                  },
                  "query":"application_name:cowrie"
               },
               "col":1,
               "row":2,
               "height":1,
               "width":1
            },
            {
               "description":"SSH - IPs - Lifetime (AWS)",
               "type":"QUICKVALUES",
               "cache_time":10,
               "configuration":{
                  "timerange":{
                     "type":"relative",
                     "range":0
                  },
                  "field":"IP_Address",
                  "query":"facility:security\\/authorization && source:ip-172-26-6-167",
                  "show_data_table":true,
                  "limit":50,
                  "show_pie_chart":false,
                  "sort_order":"desc",
                  "stacked_fields":"",
                  "data_table_limit":50
               },
               "col":3,
               "row":2,
               "height":2,
               "width":1
            },
            {
               "description":"AWS: Num. Of Successful SSH",
               "type":"SEARCH_RESULT_COUNT",
               "cache_time":10,
               "configuration":{
                  "timerange":{
                     "type":"relative",
                     "range":0
                  },
                  "lower_is_better":false,
                  "trend":true,
                  "query":"application_name:cowrie && message:succeeded && NOT IP_Address:127.0.0.1  && source:ip-172-26-6-167"
               },
               "col":3,
               "row":1,
               "height":1,
               "width":1
            },
            {
               "description":"OVH: Num. Of Successful SSH",
               "type":"SEARCH_RESULT_COUNT",
               "cache_time":10,
               "configuration":{
                  "timerange":{
                     "type":"relative",
                     "range":0
                  },
                  "lower_is_better":false,
                  "trend":true,
                  "query":"application_name:cowrie && message:succeeded && NOT IP_Address:127.0.0.1  && source:vps212252"
               },
               "col":3,
               "row":7,
               "height":1,
               "width":1
            },
            {
               "description":"Azure: Num. Of Successful SSH",
               "type":"SEARCH_RESULT_COUNT",
               "cache_time":10,
               "configuration":{
                  "timerange":{
                     "type":"relative",
                     "range":0
                  },
                  "lower_is_better":false,
                  "trend":true,
                  "query":"application_name:cowrie && message:succeeded && NOT IP_Address:127.0.0.1  && source:azure-floreant"
               },
               "col":3,
               "row":4,
               "height":1,
               "width":1
            },
            {
               "description":"SSH - IPs - Lifetime (Azure)",
               "type":"QUICKVALUES",
               "cache_time":10,
               "configuration":{
                  "timerange":{
                     "type":"relative",
                     "range":0
                  },
                  "field":"IP_Address",
                  "query":"facility:security\\/authorization && source:azure-floreant",
                  "show_data_table":true,
                  "limit":50,
                  "show_pie_chart":false,
                  "sort_order":"desc",
                  "stacked_fields":"",
                  "data_table_limit":50
               },
               "col":3,
               "row":5,
               "height":2,
               "width":1
            },
            {
               "description":"SSH - IPs - Lifetime (OVH)",
               "type":"QUICKVALUES",
               "cache_time":10,
               "configuration":{
                  "timerange":{
                     "type":"relative",
                     "range":0
                  },
                  "field":"IP_Address",
                  "query":"facility:security\\/authorization && source:vps212252",
                  "show_data_table":true,
                  "limit":50,
                  "show_pie_chart":false,
                  "sort_order":"desc",
                  "stacked_fields":"",
                  "data_table_limit":50
               },
               "col":3,
               "row":8,
               "height":2,
               "width":1
            },
            {
               "description":"SSH - IPs - Lifetime (GCP)",
               "type":"QUICKVALUES",
               "cache_time":10,
               "configuration":{
                  "timerange":{
                     "type":"relative",
                     "range":0
                  },
                  "field":"IP_Address",
                  "query":"facility:security\\/authorization && source:floreant-gcp",
                  "show_data_table":true,
                  "limit":50,
                  "show_pie_chart":false,
                  "sort_order":"desc",
                  "stacked_fields":"",
                  "data_table_limit":50
               },
               "col":3,
               "row":11,
               "height":2,
               "width":1
            },
            {
               "description":"GCP: Num. Of Successful SSH",
               "type":"SEARCH_RESULT_COUNT",
               "cache_time":10,
               "configuration":{
                  "timerange":{
                     "type":"relative",
                     "range":0
                  },
                  "lower_is_better":false,
                  "trend":true,
                  "query":"application_name:cowrie && message:succeeded && NOT IP_Address:127.0.0.1  && source:floreant-gcp"
               },
               "col":3,
               "row":10,
               "height":1,
               "width":1
            },
            {
               "description":"Web Portal - IPs - Lifetime (OVH)",
               "type":"QUICKVALUES",
               "cache_time":10,
               "configuration":{
                  "timerange":{
                     "type":"relative",
                     "range":0
                  },
                  "field":"IP_Address",
                  "query":"application_name:\"WebSwing\" && source:vps212252",
                  "show_data_table":true,
                  "limit":50,
                  "show_pie_chart":true,
                  "sort_order":"desc",
                  "stacked_fields":"",
                  "data_table_limit":50
               },
               "col":5,
               "row":7,
               "height":3,
               "width":1
            },
            {
               "description":"application breakdown",
               "type":"QUICKVALUES",
               "cache_time":10,
               "configuration":{
                  "timerange":{
                     "type":"relative",
                     "range":0
                  },
                  "field":"application_name",
                  "stream_id":"000000000000000000000001",
                  "query":"",
                  "show_data_table":true,
                  "limit":5,
                  "show_pie_chart":true,
                  "sort_order":"desc",
                  "stacked_fields":"",
                  "data_table_limit":50
               },
               "col":1,
               "row":9,
               "height":4,
               "width":2
            }
         ]
      },
      {
         "title":"Global Hit Map",
         "description":"Geo Location of IPs ",
         "dashboard_widgets":[
            {
               "description":"Global Hit Map Across All Instances",
               "type":"org.graylog.plugins.map.widget.strategy.MapWidgetStrategy",
               "cache_time":10,
               "configuration":{
                  "timerange":{
                     "type":"relative",
                     "range":0
                  },
                  "field":"IP_Address_geolocation",
                  "query":""
               },
               "col":1,
               "row":1,
               "height":3,
               "width":5
            },
            {
               "description":"OVH Global Hit Map",
               "type":"org.graylog.plugins.map.widget.strategy.MapWidgetStrategy",
               "cache_time":10,
               "configuration":{
                  "timerange":{
                     "type":"relative",
                     "range":0
                  },
                  "field":"IP_Address_geolocation",
                  "query":"source:vps212252"
               },
               "col":3,
               "row":4,
               "height":2,
               "width":2
            },
            {
               "description":"AWS Global Hit Map",
               "type":"org.graylog.plugins.map.widget.strategy.MapWidgetStrategy",
               "cache_time":10,
               "configuration":{
                  "interval":"year",
                  "timerange":{
                     "type":"relative",
                     "range":0
                  },
                  "field":"IP_Address_geolocation",
                  "query":"source: ip-172-26-6-167"
               },
               "col":1,
               "row":4,
               "height":2,
               "width":2
            },
            {
               "description":"GCP Global Hit Map",
               "type":"org.graylog.plugins.map.widget.strategy.MapWidgetStrategy",
               "cache_time":10,
               "configuration":{
                  "timerange":{
                     "type":"relative",
                     "range":0
                  },
                  "field":"IP_Address_geolocation",
                  "query":"source:floreant-gcp"
               },
               "col":1,
               "row":6,
               "height":2,
               "width":2
            },
            {
               "description":"Azure Hit Map",
               "type":"org.graylog.plugins.map.widget.strategy.MapWidgetStrategy",
               "cache_time":10,
               "configuration":{
                  "timerange":{
                     "type":"relative",
                     "range":0
                  },
                  "field":"IP_Address_geolocation",
                  "query":"source: azure-floreant"
               },
               "col":3,
               "row":6,
               "height":2,
               "width":2
            }
         ]
      }
   ],
   "grok_patterns":[
      {
         "name":"DATESTAMP_OTHER",
         "pattern":"%{DAY} %{MONTH} %{MONTHDAY} %{TIME} %{TZ} %{YEAR}"
      },
      {
         "name":"DATE",
         "pattern":"%{DATE_US}|%{DATE_EU}"
      },
      {
         "name":"HOSTPORT",
         "pattern":"%{IPORHOST}:%{POSINT}"
      },
      {
         "name":"IP",
         "pattern":"(?:%{IPV6}|%{IPV4})"
      },
      {
         "name":"HTTPD24_ERRORLOG",
         "pattern":"\\[%{HTTPDERROR_DATE:timestamp}\\] \\[%{WORD:module}:%{LOGLEVEL:loglevel}\\] \\[pid %{POSINT:pid}:tid %{NUMBER:tid}\\]( \\(%{POSINT:proxy_errorcode}\\)%{DATA:proxy_errormessage}:)?( \\[client %{IPORHOST:client}:%{POSINT:clientport}\\])? %{DATA:errorcode}: %{GREEDYDATA:message}"
      },
      {
         "name":"POSINT",
         "pattern":"\\b(?:[1-9][0-9]*)\\b"
      },
      {
         "name":"HTTPD20_ERRORLOG",
         "pattern":"\\[%{HTTPDERROR_DATE:timestamp}\\] \\[%{LOGLEVEL:loglevel}\\] (?:\\[client %{IPORHOST:clientip}\\] ){0,1}%{GREEDYDATA:errormsg}"
      },
      {
         "name":"URIPROTO",
         "pattern":"[A-Za-z]+(\\+[A-Za-z+]+)?"
      },
      {
         "name":"COMMONAPACHELOG",
         "pattern":"%{IPORHOST:clientip} %{HTTPDUSER:ident} %{USER:auth} \\[%{HTTPDATE:timestamp}\\] \"(?:%{WORD:verb} %{NOTSPACE:request}(?: HTTP/%{NUMBER:httpversion})?|%{DATA:rawrequest})\" %{NUMBER:response} (?:%{NUMBER:bytes}|-)"
      },
      {
         "name":"WORD",
         "pattern":"\\b\\w+\\b"
      },
      {
         "name":"QS",
         "pattern":"%{QUOTEDSTRING}"
      },
      {
         "name":"UUID",
         "pattern":"[A-Fa-f0-9]{8}-(?:[A-Fa-f0-9]{4}-){3}[A-Fa-f0-9]{12}"
      },
      {
         "name":"ISO8601_TIMEZONE",
         "pattern":"(?:Z|[+-]%{HOUR}(?::?%{MINUTE}))"
      },
      {
         "name":"YEAR",
         "pattern":"(?>\\d\\d){1,2}"
      },
      {
         "name":"MAC",
         "pattern":"(?:%{CISCOMAC}|%{WINDOWSMAC}|%{COMMONMAC})"
      },
      {
         "name":"INT",
         "pattern":"(?:[+-]?(?:[0-9]+))"
      },
      {
         "name":"WINPATH",
         "pattern":"(?>[A-Za-z]+:|\\\\)(?:\\\\[^\\\\?*]*)+"
      },
      {
         "name":"HTTPDATE",
         "pattern":"%{MONTHDAY}/%{MONTH}/%{YEAR}:%{TIME} %{INT}"
      },
      {
         "name":"MONTHDAY",
         "pattern":"(?:(?:0[1-9])|(?:[12][0-9])|(?:3[01])|[1-9])"
      },
      {
         "name":"SYSLOGHOST",
         "pattern":"%{IPORHOST}"
      },
      {
         "name":"HTTPDUSER",
         "pattern":"%{EMAILADDRESS}|%{USER}"
      },
      {
         "name":"MONTHNUM2",
         "pattern":"(?:0[1-9]|1[0-2])"
      },
      {
         "name":"TTY",
         "pattern":"(?:/dev/(pts|tty([pq])?)(\\w+)?/?(?:[0-9]+))"
      },
      {
         "name":"PATH",
         "pattern":"(?:%{UNIXPATH}|%{WINPATH})"
      },
      {
         "name":"CISCOMAC",
         "pattern":"(?:(?:[A-Fa-f0-9]{4}\\.){2}[A-Fa-f0-9]{4})"
      },
      {
         "name":"DATESTAMP_RFC2822",
         "pattern":"%{DAY}, %{MONTHDAY} %{MONTH} %{YEAR} %{TIME} %{ISO8601_TIMEZONE}"
      },
      {
         "name":"ISO8601_SECOND",
         "pattern":"(?:%{SECOND}|60)"
      },
      {
         "name":"GREEDYDATA",
         "pattern":".*"
      },
      {
         "name":"UNIXPATH",
         "pattern":"(/([\\w_%!$@:.,~-]+|\\\\.)*)+"
      },
      {
         "name":"TIMESTAMP_ISO8601",
         "pattern":"%{YEAR}-%{MONTHNUM}-%{MONTHDAY}[T ]%{HOUR}:?%{MINUTE}(?::?%{SECOND})?%{ISO8601_TIMEZONE}?"
      },
      {
         "name":"MONTH",
         "pattern":"\\b(?:Jan(?:uary|uar)?|Feb(?:ruary|ruar)?|M(?:a|Ã¤)?r(?:ch|z)?|Apr(?:il)?|Ma(?:y|i)?|Jun(?:e|i)?|Jul(?:y)?|Aug(?:ust)?|Sep(?:tember)?|O(?:c|k)?t(?:ober)?|Nov(?:ember)?|De(?:c|z)(?:ember)?)\\b"
      },
      {
         "name":"USER",
         "pattern":"%{USERNAME}"
      },
      {
         "name":"DATESTAMP_EVENTLOG",
         "pattern":"%{YEAR}%{MONTHNUM2}%{MONTHDAY}%{HOUR}%{MINUTE}%{SECOND}"
      },
      {
         "name":"SYSLOGBASE",
         "pattern":"%{SYSLOGTIMESTAMP:timestamp} (?:%{SYSLOGFACILITY} )?%{SYSLOGHOST:logsource} %{SYSLOGPROG}:"
      },
      {
         "name":"HOSTNAME",
         "pattern":"\\b(?:[0-9A-Za-z][0-9A-Za-z-]{0,62})(?:\\.(?:[0-9A-Za-z][0-9A-Za-z-]{0,62}))*(\\.?|\\b)"
      },
      {
         "name":"IPV6",
         "pattern":"((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:)))(%.+)?"
      },
      {
         "name":"URI",
         "pattern":"%{URIPROTO}://(?:%{USER}(?::[^@]*)?@)?(?:%{URIHOST})?(?:%{URIPATHPARAM})?"
      },
      {
         "name":"SYSLOGPROG",
         "pattern":"%{PROG:program}(?:\\[%{POSINT:pid}\\])?"
      },
      {
         "name":"HTTPDERROR_DATE",
         "pattern":"%{DAY} %{MONTH} %{MONTHDAY} %{TIME} %{YEAR}"
      },
      {
         "name":"LOGLEVEL",
         "pattern":"([Aa]lert|ALERT|[Tt]race|TRACE|[Dd]ebug|DEBUG|[Nn]otice|NOTICE|[Ii]nfo|INFO|[Ww]arn?(?:ing)?|WARN?(?:ING)?|[Ee]rr?(?:or)?|ERR?(?:OR)?|[Cc]rit?(?:ical)?|CRIT?(?:ICAL)?|[Ff]atal|FATAL|[Ss]evere|SEVERE|EMERG(?:ENCY)?|[Ee]merg(?:ency)?)"
      },
      {
         "name":"DAY",
         "pattern":"(?:Mon(?:day)?|Tue(?:sday)?|Wed(?:nesday)?|Thu(?:rsday)?|Fri(?:day)?|Sat(?:urday)?|Sun(?:day)?)"
      },
      {
         "name":"SECOND",
         "pattern":"(?:(?:[0-5]?[0-9]|60)(?:[:.,][0-9]+)?)"
      },
      {
         "name":"DATESTAMP_RFC822",
         "pattern":"%{DAY} %{MONTH} %{MONTHDAY} %{YEAR} %{TIME} %{TZ}"
      },
      {
         "name":"TIME",
         "pattern":"(?!<[0-9])%{HOUR}:%{MINUTE}(?::%{SECOND})(?![0-9])"
      },
      {
         "name":"IPORHOST",
         "pattern":"(?:%{IP}|%{HOSTNAME})"
      },
      {
         "name":"PROG",
         "pattern":"[\\x21-\\x5a\\x5c\\x5e-\\x7e]+"
      },
      {
         "name":"EMAILLOCALPART",
         "pattern":"[a-zA-Z][a-zA-Z0-9_.+-=:]+"
      },
      {
         "name":"DATE_US",
         "pattern":"%{MONTHNUM}[/-]%{MONTHDAY}[/-]%{YEAR}"
      },
      {
         "name":"URIHOST",
         "pattern":"%{IPORHOST}(?::%{POSINT:port})?"
      },
      {
         "name":"EMAILADDRESS",
         "pattern":"%{EMAILLOCALPART}@%{HOSTNAME}"
      },
      {
         "name":"URIPARAM",
         "pattern":"\\?[A-Za-z0-9$.+!*'|(){},~@#%&/=:;_?\\-\\[\\]<>]*"
      },
      {
         "name":"BASE16NUM",
         "pattern":"(?<![0-9A-Fa-f])(?:[+-]?(?:0x)?(?:[0-9A-Fa-f]+))"
      },
      {
         "name":"IPV4",
         "pattern":"(?<![0-9])(?:(?:[0-1]?[0-9]{1,2}|2[0-4][0-9]|25[0-5])[.](?:[0-1]?[0-9]{1,2}|2[0-4][0-9]|25[0-5])[.](?:[0-1]?[0-9]{1,2}|2[0-4][0-9]|25[0-5])[.](?:[0-1]?[0-9]{1,2}|2[0-4][0-9]|25[0-5]))(?![0-9])"
      },
      {
         "name":"QUOTEDSTRING",
         "pattern":"(?>(?<!\\\\)(?>\"(?>\\\\.|[^\\\\\"]+)+\"|\"\"|(?>'(?>\\\\.|[^\\\\']+)+')|''|(?>`(?>\\\\.|[^\\\\`]+)+`)|``))"
      },
      {
         "name":"MINUTE",
         "pattern":"(?:[0-5][0-9])"
      },
      {
         "name":"TZ",
         "pattern":"(?:[PMCE][SD]T|UTC)"
      },
      {
         "name":"DATESTAMP",
         "pattern":"%{DATE}[- ]%{TIME}"
      },
      {
         "name":"URIPATH",
         "pattern":"(?:/[A-Za-z0-9$.+!*'(){},~:;=@#%_\\-]*)+"
      },
      {
         "name":"HOUR",
         "pattern":"(?:2[0123]|[01]?[0-9])"
      },
      {
         "name":"COMBINEDAPACHELOG",
         "pattern":"%{COMMONAPACHELOG} %{QS:referrer} %{QS:agent}"
      },
      {
         "name":"NUMBER",
         "pattern":"(?:%{BASE10NUM})"
      },
      {
         "name":"WINDOWSMAC",
         "pattern":"(?:(?:[A-Fa-f0-9]{2}-){5}[A-Fa-f0-9]{2})"
      },
      {
         "name":"DATE_EU",
         "pattern":"%{MONTHDAY}[./-]%{MONTHNUM}[./-]%{YEAR}"
      },
      {
         "name":"SYSLOGFACILITY",
         "pattern":"<%{NONNEGINT:facility}.%{NONNEGINT:priority}>"
      },
      {
         "name":"BASE16FLOAT",
         "pattern":"\\b(?<![0-9A-Fa-f.])(?:[+-]?(?:0x)?(?:(?:[0-9A-Fa-f]+(?:\\.[0-9A-Fa-f]*)?)|(?:\\.[0-9A-Fa-f]+)))\\b"
      },
      {
         "name":"SYSLOGTIMESTAMP",
         "pattern":"%{MONTH} +%{MONTHDAY} %{TIME}"
      },
      {
         "name":"NOTSPACE",
         "pattern":"\\S+"
      },
      {
         "name":"HTTPD_ERRORLOG",
         "pattern":"%{HTTPD20_ERRORLOG}|%{HTTPD24_ERRORLOG}"
      },
      {
         "name":"USERNAME",
         "pattern":"[a-zA-Z0-9._-]+"
      },
      {
         "name":"SPACE",
         "pattern":"\\s*"
      },
      {
         "name":"URIPATHPARAM",
         "pattern":"%{URIPATH}(?:%{URIPARAM})?"
      },
      {
         "name":"COMMONMAC",
         "pattern":"(?:(?:[A-Fa-f0-9]{2}:){5}[A-Fa-f0-9]{2})"
      },
      {
         "name":"BASE10NUM",
         "pattern":"(?<![0-9.+-])(?>[+-]?(?:(?:[0-9]+(?:\\.[0-9]+)?)|(?:\\.[0-9]+)))"
      },
      {
         "name":"NONNEGINT",
         "pattern":"\\b(?:[0-9]+)\\b"
      },
      {
         "name":"DATA",
         "pattern":".*?"
      },
      {
         "name":"MONTHNUM",
         "pattern":"(?:0?[1-9]|1[0-2])"
      }
   ],
   "lookup_tables":[
      {
         "title":"abuse.ch Ransomware Domains",
         "description":"This is the lookup table for the abuse.ch ransomware Domain Tracker, listing infrastructure by domain names which are used for ransomware. For more information see https://ransomwaretracker.abuse.ch. This lookup table is used internally by Graylog's Threat Intel Plugin. Do not delete it manually.",
         "name":"abuse-ch-ransomware-domains",
         "cache_name":"threat-intel-uncached-adapters",
         "data_adapter_name":"abuse-ch-ransomware-domains",
         "default_single_value":"",
         "default_single_value_type":"NULL",
         "default_multi_value":"",
         "default_multi_value_type":"NULL"
      },
      {
         "title":"Open Thread Exchange (OTX) - IP",
         "description":"This is the lookup table for AlienVault's Open Thread Exchange platform, containing crowd-sourced IoCs (Indicators of Compromise). For more information see https://otx.alienvault.com. This lookup table is used internally by Graylog's Threat Intel Plugin. Do not delete it manually.",
         "name":"otx-api-ip",
         "cache_name":"otx-api-ip-cache",
         "data_adapter_name":"otx-api-ip",
         "default_single_value":"",
         "default_single_value_type":"NULL",
         "default_multi_value":"",
         "default_multi_value_type":"NULL"
      },
      {
         "title":"abuse.ch Ransomware IP",
         "description":"This is the lookup table for the abuse.ch ransomware IP Tracker, listing infrastructure by IP which is used for ransomware. For more information see https://ransomwaretracker.abuse.ch. This lookup table is used internally by Graylog's Threat Intel Plugin. Do not delete it manually.",
         "name":"abuse-ch-ransomware-ip",
         "cache_name":"threat-intel-uncached-adapters",
         "data_adapter_name":"abuse-ch-ransomware-ip",
         "default_single_value":"",
         "default_single_value_type":"NULL",
         "default_multi_value":"",
         "default_multi_value_type":"NULL"
      },
      {
         "title":"Tor Exit Node List",
         "description":"This is the lookup table for the TOR (The Onion Router) Exit Node List, listing Exit Nodes of the TOR Network . This lookup table is used internally by Graylog's Threat Intel Plugin. Do not delete it manually.",
         "name":"tor-exit-node-list",
         "cache_name":"threat-intel-uncached-adapters",
         "data_adapter_name":"tor-exit-node",
         "default_single_value":"",
         "default_single_value_type":"NULL",
         "default_multi_value":"",
         "default_multi_value_type":"NULL"
      },
      {
         "title":"Spamhaus DROP",
         "description":"This is the lookup table for Spamhaus' DROP (Don't Route Or Peer) list, containing netblocks which are \"hijacked\" or leased by professional spam or cyber-crime operations. For more information see https://www.spamhaus.org/drop. This lookup table is used internally by Graylog's Threat Intel Plugin. Do not delete it manually.",
         "name":"spamhaus-drop",
         "cache_name":"spamhaus-e-drop-cache",
         "data_adapter_name":"spamhaus-drop",
         "default_single_value":"",
         "default_single_value_type":"NULL",
         "default_multi_value":"",
         "default_multi_value_type":"NULL"
      },
      {
         "title":"Whois",
         "description":"This is the lookup table for the WHOIS database, listing registered users of Internet resources like IPs, Netblocks or Domain Names. This lookup table is used internally by Graylog's Threat Intel Plugin. Do not delete it manually.",
         "name":"whois",
         "cache_name":"whois-cache",
         "data_adapter_name":"whois",
         "default_single_value":"",
         "default_single_value_type":"NULL",
         "default_multi_value":"",
         "default_multi_value_type":"NULL"
      },
      {
         "title":"Open Thread Exchange (OTX) - Domain",
         "description":"This is the lookup table for AlienVault's Open Thread Exchange platform, containing crowd-sourced IoCs (Indicators of Compromise). For more information see https://otx.alienvault.com. This lookup table is used internally by Graylog's Threat Intel Plugin. Do not delete it manually.",
         "name":"otx-api-domain",
         "cache_name":"otx-api-domain-cache",
         "data_adapter_name":"otx-api-domain",
         "default_single_value":"",
         "default_single_value_type":"NULL",
         "default_multi_value":"",
         "default_multi_value_type":"NULL"
      }
   ],
   "lookup_caches":[
      {
         "title":"Open Threat Exchange (OTX) - Domain Cache",
         "description":"This is the cache for AlienVault's Open Thread Exchange platform, containing crowd-sourced IoCs (Indicators of Compromise). For more information see https://otx.alienvault.com. This cache is used internally by Graylog's Threat Intel Plugin. Do not delete it manually.",
         "name":"otx-api-domain-cache",
         "config":{
            "type":"guava_cache",
            "max_size":1000,
            "expire_after_access":0,
            "expire_after_access_unit":"SECONDS",
            "expire_after_write":60,
            "expire_after_write_unit":"SECONDS"
         }
      },
      {
         "title":"Whois Cache",
         "description":"This is the cache for the WHOIS database, listing registered users of Internet resources like IPs, Netblocks or Domain Names. This cache is used internally by Graylog's Threat Intel Plugin. Do not delete it manually.",
         "name":"whois-cache",
         "config":{
            "type":"guava_cache",
            "max_size":1000,
            "expire_after_access":0,
            "expire_after_access_unit":"DAYS",
            "expire_after_write":1,
            "expire_after_write_unit":"DAYS"
         }
      },
      {
         "title":"Threat Intel Uncached Adapters",
         "description":"Certain downloaded lists do not require caching because they are in memory already and use this no-op cache.",
         "name":"threat-intel-uncached-adapters",
         "config":{
            "type":"none"
         }
      },
      {
         "title":"Spamhaus (E)DROP Cache",
         "description":"This is the cache for Spamhaus' (E)DROP (Don't Route Or Peer) list, containing netblocks which are \"hijacked\" or leased by professional spam or cyber-crime operations. For more information see https://www.spamhaus.org/drop. This cache is used internally by Graylog's Threat Intel Plugin. Do not delete it manually.",
         "name":"spamhaus-e-drop-cache",
         "config":{
            "type":"guava_cache",
            "max_size":1000,
            "expire_after_access":0,
            "expire_after_access_unit":"SECONDS",
            "expire_after_write":1,
            "expire_after_write_unit":"DAYS"
         }
      },
      {
         "title":"Open Threat Exchange (OTX) - IP Cache",
         "description":"This is the cache for AlienVault's Open Thread Exchange platform, containing crowd-sourced IoCs (Indicators of Compromise). For more information see https://otx.alienvault.com. This cache is used internally by Graylog's Threat Intel Plugin. Do not delete it manually.",
         "name":"otx-api-ip-cache",
         "config":{
            "type":"guava_cache",
            "max_size":1000,
            "expire_after_access":0,
            "expire_after_access_unit":"SECONDS",
            "expire_after_write":60,
            "expire_after_write_unit":"SECONDS"
         }
      }
   ],
   "lookup_data_adapters":[
      {
         "title":"Whois",
         "description":"This is the data adapter for the WHOIS database, listing registered users of Internet resources like IPs, Netblocks or Domain Names. This adapter is used internally by Graylog's Threat Intel Plugin. Do not delete it manually.",
         "name":"whois",
         "config":{
            "type":"whois",
            "registry":"ARIN",
            "connect_timeout":1000,
            "read_timeout":1000
         }
      },
      {
         "title":"Spamhaus DROP",
         "description":"This is the data adapter for Spamhaus' DROP (Don't Route Or Peer) list, containing netblocks which are \"hijacked\" or leased by professional spam or cyber-crime operations. For more information see https://www.spamhaus.org/drop. This adapter is used internally by Graylog's Threat Intel Plugin. Do not delete it manually.",
         "name":"spamhaus-drop",
         "config":{
            "type":"spamhaus-edrop",
            "refresh_interval":43200
         }
      },
      {
         "title":"Tor Exit Node",
         "description":"This is the data adapter for the TOR (The Onion Router) Exit Node List, listing Exit Nodes of the TOR Network . This adapter is used internally by Graylog's Threat Intel Plugin. Do not delete it manually.",
         "name":"tor-exit-node",
         "config":{
            "type":"torexitnode"
         }
      },
      {
         "title":"abuse.ch ransomware Domains",
         "description":"This is the data adapter for the abuse.ch ransomware Domain Tracker, listing infrastructure by domain names which are used for ransomware. For more information see https://ransomwaretracker.abuse.ch. This adapter is used internally by Graylog's Threat Intel Plugin. Do not delete it manually.",
         "name":"abuse-ch-ransomware-domains",
         "config":{
            "type":"abuse-ch-ransom",
            "refresh_interval":150,
            "refresh_interval_unit":"SECONDS",
            "blocklist_type":"DOMAINS"
         }
      },
      {
         "title":"Open Thread Exchange (OTX) - Domain",
         "description":"This is the data adapter for AlienVault's Open Thread Exchange platform, containing crowd-sourced IoCs (Indicators of Compromise). For more information see https://otx.alienvault.com. This adapter is used internally by Graylog's Threat Intel Plugin. Do not delete it manually.",
         "name":"otx-api-domain",
         "config":{
            "type":"otx-api",
            "indicator":"domain",
            "api_url":"https://otx.alienvault.com",
            "http_user_agent":"Graylog Threat Intelligence Plugin - https://github.com/Graylog2/graylog-plugin-threatintel",
            "http_connect_timeout":10000,
            "http_write_timeout":10000,
            "http_read_timeout":60000
         }
      },
      {
         "title":"abuse.ch ransomware IP",
         "description":"This is the data adapter for the abuse.ch ransomware IP Tracker, listing infrastructure by IP which is used for ransomware. For more information see https://ransomwaretracker.abuse.ch. This adapter is used internally by Graylog's Threat Intel Plugin. Do not delete it manually.",
         "name":"abuse-ch-ransomware-ip",
         "config":{
            "type":"abuse-ch-ransom",
            "refresh_interval":150,
            "refresh_interval_unit":"SECONDS",
            "blocklist_type":"IPS"
         }
      },
      {
         "title":"Open Thread Exchange (OTX) - IP",
         "description":"This is the data adapter for AlienVault's Open Thread Exchange platform, containing crowd-sourced IoCs (Indicators of Compromise). For more information see https://otx.alienvault.com. This adapter is used internally by Graylog's Threat Intel Plugin. Do not delete it manually.",
         "name":"otx-api-ip",
         "config":{
            "type":"otx-api",
            "indicator":"IPAutoDetect",
            "api_url":"https://otx.alienvault.com",
            "http_user_agent":"Graylog Threat Intelligence Plugin - https://github.com/Graylog2/graylog-plugin-threatintel",
            "http_connect_timeout":10000,
            "http_write_timeout":10000,
            "http_read_timeout":60000
         }
      }
   ]
}
